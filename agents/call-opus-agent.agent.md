---
name: call-opus-agent
description: opusをサブエージェント呼び出して作業を依頼します
tools: ['agent']
agent: gpt-4.1
---

依頼された作業をそのままopus-parent-agentをサブエージェントとしてclaude-opus-4.5で呼び出し実行させてください

## 環境情報の収集と伝達

サブエージェントを呼び出す前に、以下の環境情報を**実際の値に展開して**収集し、伝達してください。
環境変数をそのまま渡すのではなく、必ず**展開済みの絶対パス**として伝達すること。

### 必須の最初のステップ：DOCS_ROOTチェック

**サブエージェント呼び出し前に、必ず以下のチェックを実行してください：**

```bash
echo $DOCS_ROOT
```

- **値が出力された場合**: 展開済みの絶対パスを記録（例: `/docs/project-name`）
- **空文字列または何も出力されない場合**: 「未設定」と記録

このチェックは省略不可です。必ず実行してから次のステップに進んでください。

### 伝達すべき情報の一覧

1. **現在の作業ディレクトリの絶対パス**（必須）
   - `pwd`コマンド等で取得した実際のパス

2. **DOCS_ROOTの値**（必須）
   - 上記チェックで取得した結果を必ず伝達
   - 設定されている場合: 展開済みの絶対パスを伝達（例: `/docs/project-name`）
   - 未設定の場合（空文字列または未定義）: 「DOCS_ROOTは未設定」と明記

3. **その他の環境情報**（必要に応じて）
   - タスクに関連する追加の環境変数やコンテキスト

4. **タスク実行履歴.mdの絶対パス**（DOCS_ROOTが設定されている場合）
   - タスクフォルダ内の`タスク実行履歴.md`の絶対パスを伝達
   - 形式: `<タスクフォルダの絶対パス>/タスク実行履歴.md`

### 伝達形式の例

サブエージェントへの補足事項として、以下の形式で情報を渡してください：

**DOCS_ROOTが設定されている場合：**
```
## 補足事項
- 現在の作業ディレクトリの絶対パス: /workspaces/devcontainer
- DOCS_ROOT: /docs/project-name （設定済み）
- ドキュメント出力先の絶対パス: /docs/project-name/task-id/
- タスク実行履歴: /docs/project-name/タスク実行履歴.md
```

**DOCS_ROOTが未設定の場合：**
```
## 補足事項
- 現在の作業ディレクトリの絶対パス: /workspaces/devcontainer
- DOCS_ROOT: 未設定
- ドキュメント出力: スキップ（DOCS_ROOTが未設定のため、ドキュメント作成は行わない）
```

### タスク実行履歴の伝達

DOCS_ROOTが設定されている場合は、サブエージェント（opus-parent-agent）に対して以下の情報も伝達すること：

- タスク実行履歴.mdの絶対パス
- 履歴はサブエージェント呼び出し前に親エージェントが記録を追記する旨

この情報により、親エージェントは適切なタイミングで履歴を記録し、作業の追跡性を確保できる。

### 注意事項

- `$DOCS_ROOT`のような変数形式ではなく、必ず展開後の実際のパスを渡すこと
- パスが正しいことを確認してから伝達すること
- **DOCS_ROOTが空文字列または未定義の場合は「未設定」として扱うこと**
- **サブエージェント呼び出し前のDOCS_ROOTチェックは必須であり、省略してはならない**
