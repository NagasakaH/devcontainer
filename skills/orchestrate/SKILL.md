---
name: orchestrate
description: エージェントオーケストレーションのガイド。複数のエージェントを順次実行し、複雑なタスクを完遂するためのワークフロー管理を行う。機能開発、バグ修正、リファクタリング、セキュリティレビューなど、複数の専門エージェントの連携が必要な場合に使用。「オーケストレーション」「ワークフロー実行」「エージェント連携」「順次実行」などのフレーズで発動。
---

# オーケストレーション（Orchestrate）

複雑なタスクに対する順次エージェントワークフロー。

## このスキルの目的

1. **ワークフロー定義** - タスクに適したエージェントチェーンを選択
2. **順次実行** - エージェント間でコンテキストを引き継ぎながら実行
3. **結果の集約** - 各エージェントの出力を最終レポートにまとめる

## ワークフロータイプ

### feature（機能開発）

完全な機能実装ワークフロー：

```
planner -> tdd-guide -> code-reviewer -> security-reviewer
```

### bugfix（バグ修正）

バグ調査と修正ワークフロー：

```
explorer -> tdd-guide -> code-reviewer
```

### refactor（リファクタリング）

安全なリファクタリングワークフロー：

```
architect -> code-reviewer -> tdd-guide
```

### security（セキュリティ）

セキュリティ重視のレビュー：

```
security-reviewer -> code-reviewer -> architect
```

## 実行パターン

ワークフロー内の各エージェントに対して：

1. **エージェントを起動** - 前のエージェントからのコンテキストを渡す
2. **出力を収集** - 構造化された引き継ぎドキュメントとして取得
3. **次のエージェントに渡す** - チェーン内の次へ
4. **結果を集約** - 最終レポートにまとめる

## 引き継ぎドキュメント形式

エージェント間で以下の形式の引き継ぎドキュメントを作成する：

```markdown
## HANDOFF: {前のエージェント} -> {次のエージェント}

### コンテキスト
{実施した内容のサマリー}

### 発見事項
{重要な発見や決定事項}

### 変更ファイル
{変更したファイルのリスト}

### 未解決の質問
{次のエージェントへの未解決項目}

### 推奨事項
{推奨される次のステップ}
```

## 使用例: 機能開発ワークフロー

タスク: 「ユーザー認証を追加」

実行内容：

1. **Planner エージェント**
   - 要件を分析
   - 実装計画を作成
   - 依存関係を特定
   - 出力: `HANDOFF: planner -> tdd-guide`

2. **TDD Guide エージェント**
   - Plannerの引き継ぎを読み込む
   - テストを先に作成
   - テストをパスするよう実装
   - 出力: `HANDOFF: tdd-guide -> code-reviewer`

3. **Code Reviewer エージェント**
   - 実装をレビュー
   - 問題点をチェック
   - 改善点を提案
   - 出力: `HANDOFF: code-reviewer -> security-reviewer`

4. **Security Reviewer エージェント**
   - セキュリティ監査
   - 脆弱性チェック
   - 最終承認
   - 出力: 最終レポート

## 最終レポート形式

```
オーケストレーションレポート
============================
ワークフロー: feature
タスク: ユーザー認証を追加
エージェント: planner -> tdd-guide -> code-reviewer -> security-reviewer

サマリー
--------
{1段落のサマリー}

エージェント出力
----------------
Planner: {サマリー}
TDD Guide: {サマリー}
Code Reviewer: {サマリー}
Security Reviewer: {サマリー}

変更ファイル
------------
{変更した全ファイルのリスト}

テスト結果
----------
{テストのパス/失敗サマリー}

セキュリティステータス
----------------------
{セキュリティに関する発見事項}

推奨
----
{SHIP / 要対応 / ブロック}
```

## 並列実行

独立したチェックは並列で実行可能：

```markdown
### 並列フェーズ
同時に実行：
- code-reviewer（品質）
- security-reviewer（セキュリティ）
- architect（設計）

### 結果のマージ
出力を単一のレポートに統合
```

## 引数

- `feature {説明}` - 完全な機能開発ワークフロー
- `bugfix {説明}` - バグ修正ワークフロー
- `refactor {説明}` - リファクタリングワークフロー
- `security {説明}` - セキュリティレビューワークフロー
- `custom {エージェントリスト} {説明}` - カスタムエージェントシーケンス

## カスタムワークフロー例

タスク: 「キャッシュ層を再設計」

```
custom "architect,tdd-guide,code-reviewer" "キャッシュ層を再設計"
```

## ベストプラクティス

1. **複雑な機能はplannerから開始** - 要件を明確化してから進める
2. **マージ前は必ずcode-reviewerを含める** - 品質を担保
3. **認証/決済/個人情報にはsecurity-reviewerを使用** - セキュリティリスクを軽減
4. **引き継ぎは簡潔に** - 次のエージェントに必要な情報に集中
5. **必要に応じてエージェント間で検証を実行** - 中間成果物を確認
