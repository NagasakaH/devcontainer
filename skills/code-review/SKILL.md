---
name: code-review
description: コード変更のセキュリティと品質をレビューするスキル。コミット前の変更点を分析し、セキュリティ脆弱性、コード品質の問題、ベストプラクティス違反を検出します。「コードレビュー」「セキュリティチェック」「品質チェック」などのフレーズでトリガーされます。
---

# コードレビュー

## 概要

コミットされていない変更に対して、包括的なセキュリティと品質のレビューを実行します。

## 使用方法

### 1. 変更ファイルの取得

```bash
git diff --name-only HEAD
```

### 2. 各変更ファイルのチェック項目

#### セキュリティ問題（CRITICAL - 重大）

以下の項目を必ずチェックしてください：

- ハードコードされた認証情報、APIキー、トークン
- SQLインジェクション脆弱性
- XSS（クロスサイトスクリプティング）脆弱性
- 入力バリデーションの欠如
- 安全でない依存関係
- パストラバーサルのリスク

#### コード品質（HIGH - 高）

以下の品質基準をチェックしてください：

- 50行を超える関数
- 800行を超えるファイル
- 4レベルを超えるネスト深度
- エラーハンドリングの欠如
- `console.log` 文の残存
- TODO/FIXME コメント
- パブリックAPIのJSDoc欠如

#### ベストプラクティス（MEDIUM - 中）

以下のベストプラクティスをチェックしてください：

- ミューテーションパターン（イミュータブルな方法を推奨）
- コード/コメント内の絵文字使用
- 新規コードに対するテストの欠如
- アクセシビリティ（a11y）の問題

### 3. レポートの生成

レポートには以下の情報を含めてください：

| 項目 | 説明 |
|------|------|
| 重大度 | CRITICAL, HIGH, MEDIUM, LOW |
| ファイル位置 | ファイルパスと行番号 |
| 問題の説明 | 検出された問題の詳細 |
| 修正案 | 推奨される修正方法 |

### 4. コミットのブロック

**CRITICAL または HIGH の問題が見つかった場合、コミットをブロックしてください。**

## 重要な原則

> ⚠️ **セキュリティ脆弱性のあるコードは絶対に承認しないでください！**

## レビュー実行スクリプト

簡易的なレビューを実行するには：

```bash
bash scripts/review.sh
```

このスクリプトは変更されたファイルを一覧表示し、基本的なチェックを実行します。
