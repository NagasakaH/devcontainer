---
name: update-docs
description: ドキュメント更新ガイド。ソースコードの信頼できる情報源（Single Source of Truth）からドキュメントを同期・更新する。package.jsonや.env.exampleから自動的にドキュメントを生成し、古いドキュメントを特定する。「ドキュメント更新」「docs更新」「ドキュメント同期」などのフレーズで発動。
---

# ドキュメント更新（Update Documentation）

信頼できる情報源からドキュメントを同期・更新するためのガイド。

## このスキルの目的

ソースコードの信頼できる情報源（Single Source of Truth）からドキュメントを自動的に生成・更新し、ドキュメントとコードの整合性を保つ。

**信頼できる情報源**: `package.json` と `.env.example`

## ワークフロー

### ステップ1: package.json のスクリプトセクションを読み取る

`package.json` の `scripts` セクションから以下を生成する：

- スクリプトリファレンステーブルを生成
- コメントから説明文を含める

```markdown
## 利用可能なスクリプト

| スクリプト | 説明 |
|-----------|------|
| `npm run build` | プロジェクトをビルド |
| `npm run test` | テストを実行 |
| `npm run lint` | リンターを実行 |
```

### ステップ2: .env.example を読み取る

`.env.example` から以下を抽出する：

- すべての環境変数を抽出
- 目的と形式をドキュメント化

```markdown
## 環境変数

| 変数名 | 説明 | 形式 |
|--------|------|------|
| `DATABASE_URL` | データベース接続文字列 | `postgresql://...` |
| `API_KEY` | API認証キー | 文字列 |
```

### ステップ3: docs/CONTRIB.md を生成

以下の内容を含むコントリビューションガイドを生成する：

- 開発ワークフロー
- 利用可能なスクリプト
- 環境セットアップ
- テスト手順

### ステップ4: docs/RUNBOOK.md を生成

以下の内容を含む運用手順書を生成する：

- デプロイ手順
- 監視とアラート
- よくある問題と解決策
- ロールバック手順

### ステップ5: 古いドキュメントの特定

陳腐化したドキュメントを特定する：

- 90日以上更新されていないドキュメントを検索
- 手動レビュー用にリストアップ

```bash
# 90日以上更新されていないドキュメントを検索
find docs -name "*.md" -mtime +90 -type f
```

### ステップ6: 差分サマリーを表示

更新内容の差分サマリーを表示する：

- 追加・変更・削除された内容
- 影響を受けるファイル

## ドキュメントテンプレート

### CONTRIB.md テンプレート

```markdown
# コントリビューションガイド

## 開発環境のセットアップ

1. リポジトリをクローン
2. 依存関係をインストール: `npm install`
3. 環境変数を設定: `.env.example` を `.env` にコピー

## 開発ワークフロー

### ブランチ戦略
- `main`: 本番ブランチ
- `develop`: 開発ブランチ
- `feature/*`: 機能ブランチ

### 利用可能なスクリプト

{package.jsonから自動生成}

## テスト

### テストの実行
{テストコマンドと説明}

### テストの書き方
{テスト規約}

## 環境変数

{.env.exampleから自動生成}
```

### RUNBOOK.md テンプレート

```markdown
# 運用手順書（Runbook）

## デプロイ手順

### 本番環境へのデプロイ
{デプロイ手順}

### ステージング環境へのデプロイ
{デプロイ手順}

## 監視とアラート

### 監視項目
- {監視項目1}
- {監視項目2}

### アラート対応
{アラート対応手順}

## よくある問題と解決策

### 問題1: {問題の説明}
**症状**: {症状}
**原因**: {原因}
**解決策**: {解決策}

## ロールバック手順

### 即座のロールバック
{ロールバック手順}

### データベースのロールバック
{データベースロールバック手順}
```

## 重要な注意事項

1. **信頼できる情報源を優先**: ドキュメントは `package.json` と `.env.example` の内容を反映する
2. **定期的な同期**: コード変更後はドキュメントも更新する
3. **古いドキュメントの管理**: 90日以上更新されていないドキュメントはレビュー対象
4. **差分の確認**: 更新前に必ず差分を確認し、意図しない変更がないか確認する
